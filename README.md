# Week1--
Week1-æŒ‰ç…§è¦æ±‚è¿›è¡Œçˆ¬è™«å’Œé‡åŒ–é€‰è‚¡


-ä»â€œæˆ‘çš„ç ”ç©¶â€å¼€å§‹ï¼Œå¯¼å‡ºè‚¡ç¥¨åˆ°excelæ–‡æ¡£ï¼šå‰ä¸‰ä¸ªäº¤æ˜“æ—¥æ¶¨è·Œå¹…åœ¨-5åˆ°15ä¹‹é—´ï¼Œ10æ—¥å‡çº¿æ–œç‡å¤§äº-5çš„è‚¡ç¥¨ï¼Œå¹¶ä¸”åˆ—å‡ºå‰ä¸‰ä¸ªäº¤æ˜“æ—¥åŒºé—´æ¶¨å¹…ï¼Œåä¸€ä¸ªäº¤æ˜“æ—¥æœ€å¤§æ¶¨å¹…ï¼Œæ¶¨è·Œå¹…ï¼Œå¹¶æŒ‰æˆäº¤é¢æ’åºã€‚ 
ç”¨é—®è´¢é€‰è‚¡å‡½æ•°æ¥è·å–ä¸Šè¿°è‚¡ç¥¨ï¼Œâ€œæˆäº¤é¢æ’åºâ€œï¼Œâ€å‰3ä¸ªäº¤æ˜“æ—¥åŒºé—´æ¶¨å¹…åœ¨-10%å’Œ15%ä¹‹é—´â€œï¼Œâ€10æ—¥å‡çº¿æ–œç‡å¤§äº-5â€œï¼Œâ€å‰ä¸‰ä¸ªäº¤æ˜“æ—¥åŒºé—´æ¶¨å¹…â€œï¼Œâ€åä¸€ä¸ªäº¤æ˜“æ—¥æœ€å¤§æ¶¨å¹…â€œï¼Œâ€æ¶¨è·Œå¹…â€œ

df = query_iwencai("æˆäº¤é¢æ’åº, å‰3ä¸ªäº¤æ˜“æ—¥åŒºé—´æ¶¨å¹…åœ¨-10%å’Œ15%ä¹‹é—´, 10æ—¥å‡çº¿æ–œç‡å¤§äº-5, å‰ä¸‰ä¸ªäº¤æ˜“æ—¥åŒºé—´æ¶¨å¹…, åä¸€ä¸ªäº¤æ˜“æ—¥æœ€å¤§æ¶¨å¹…, æ¶¨è·Œå¹…")
df = pd.DataFrame(df)
df.to_excel('output.xlsx', index=False, engine='xlsxwriter')
å¯¼å‡ºè‚¡ç¥¨é“¾æ¥ğŸ”—å¦‚ä¸‹
[output.xlsx](https://github.com/user-attachments/files/16570355/output.xlsx)



-å¯¼å‡º2023å¹´å…¨éƒ¨çš„åœ°å¤©æ¿è‚¡ç¥¨ï¼Œå±•ç¤ºå…¶æ¬¡æ—¥æ¶¨è·Œå¹…ï¼Œå3æ—¥æ¶¨è·Œå¹…  ä»£ç å¦‚ä¸‹

# è·å–æ‰€æœ‰è‚¡ç¥¨çš„åŸºæœ¬ä¿¡æ¯
all_stocks = get_all_securities(ty='stock')
#all_stocks
# æå–è‚¡ç¥¨ä»£ç 
stock_codes = all_stocks.index.tolist()
stock_codes


# è·å–2023å¹´çš„æ‰€æœ‰è‚¡ç¥¨ä¿¡æ¯
data = get_price(stock_codes, '20230101 09:00', '20231231 16:00', '1m', ['close', 'open', 'low', 'high'])
# è¯»å–20234å¹´æ‰€æœ‰è‚¡ç¥¨çš„æ•°æ®ï¼Œå­˜å…¥data
## data = get_price(['000001.SZ', '600519.SH'], '20230101 09:00', '20231231 16:00', '1m', ['close', 'open', 'low', 'high'])
dtb_stocks = {} # åˆ›å»ºç©ºçš„ç»“æœå­—å…¸ï¼Œç”¨äºä¿å­˜æ¯åªè‚¡ç¥¨çš„æ¬¡æ—¥å’Œåä¸‰æ—¥æ¶¨è·Œå¹…

###
for stock, df in data.items():
    # ç­›é€‰åœ°å¤©æ¿æ¡ä»¶ï¼šå¼€ç›˜ä»·ç­‰äºæœ€ä½ä»·ï¼Œæ”¶ç›˜ä»·ç­‰äºæœ€é«˜ä»·
    is_dtb = (df['open'] == df['low']) & (df['close'] == df['high'])
    
    # è·å–ç¬¦åˆæ¡ä»¶çš„æ—¥æœŸå’Œå¯¹åº”æ•°æ®
    dtb_dates = df[is_dtb]
    
    if not dtb_dates.empty:
        dtb_stocks[stock] = dtb_dates
        

# æ‰“å°ç»“æœ
for stock, dtb_df in dtb_stocks.items():
    print(f"åœ°å¤©æ¿è‚¡ç¥¨: {stock}")
    print(dtb_df)
    
    
    
    
###
# è®¡ç®—æ¬¡æ—¥æ¶¨è·Œå¹…å’Œåä¸‰æ—¥æ¶¨è·Œå¹…   
for stock, df in data.items():
    # è®¡ç®—æ¬¡æ—¥æ¶¨è·Œå¹…
    df['next_day_return'] = (df['close'].shift(-1) - df['close']) / df['close'] * 100
    
    # è®¡ç®—åä¸‰æ—¥æ¶¨è·Œå¹…
    df['three_days_return'] = (df['close'].shift(-3) - df['close']) / df['close'] * 100
    
    # ä¿å­˜ç»“æœ
    results[stock] = df[['next_day_return', 'three_days_return']]   
    
####   

# å°†æ‰€æœ‰ç»“æœåˆå¹¶ä¸ºä¸€ä¸ªDataFrameï¼Œä¾¿äºåç»­åˆ†ææˆ–å¯¼å‡º
final_df = pd.concat(results)

# å±•ç¤ºç»“æœ
print(final_df)

# å¦‚æœéœ€è¦å°†ç»“æœä¿å­˜ä¸ºExcelæ–‡ä»¶
final_df.to_excel("all_stocks_returns_2023.xlsx")

